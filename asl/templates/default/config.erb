# Generated by Chef
# ASL Cookbook is not supported or endorsed by ASL.
# Cookbook stemmed from thread:
# http://atomicorp.com/forum/viewtopic.php?f=1&t=5507

# Authentication information
USERNAME="<%= node[:asl][:username] %>"
PASSWORD="<%= node[:asl][:password] %>"
UPDATEPATH="www.atomicorp.com/channels/asl-<%= node[:asl][:update_channel] %>/rules/"
ASLHOME="/var/asl"

# ASL Web Settings
ALERTS_USE_DB="<%= node[:asl][:use_web_db] %>"
ASL_DB_RETENTION="7 days"

# ASL Data Paths
PATH_EVENT_LOG="/var/ossec/logs/alerts/alerts.log"
PATH_DISABLED_SIG="/etc/asl/disabled_signatures"
PATH_SEC_MODULE="/var/asl/data/security-modules"
PATH_SIG_UPDATE="/var/asl/data/updates-data"
PATH_VULNERABILITY="/var/asl/data/vulnerability-data"
PATH_VULNERABILITY_REPORT="/var/asl/data/vulnerability-report.html"
PATH_VULNERABILITY_TEMPLATES="/var/asl/data/templates"
PATH_VULNERABILITY_XML="/usr/local/psa/admin/htdocs/asl/lib/reports/data.xml"
PATH_RSS="http://www.atomicorp.com/news.feed"
IP_WHITELIST="/etc/asl/whitelist"
PATH_BLACKLIST="/etc/asl/blacklist"
PATH_GEOBLACKLIST="/etc/asl/geo-blacklist"
PATH_TLD="/etc/asl/tld_country.txt"
PATH_SYSCHECK="/var/ossec/queue/syscheck/syscheck"
PATH_WEBAPP_DB="/var/asl/data/webapp.db"

# ASL general configuration.
NOTIFY="<%= node[:asl][:notify] %>"
EMAIL="<%= node[:asl][:notify_email] %>"
HOSTNAME="<%= node[:hostname] %>"
ADMIN_USERS=""
SYSTEM_TYPE="webserver"
AUTOMATIC_UPDATES="<%= node[:asl][:autoupdates] %>"
UPDATE_TYPE="all"
RESTART_APACHE="graceful"
APACHE_RESTART_COMMAND="/etc/init.d/httpd restart"
ASL_USER="tortix"
FEED_TYPE="real-time"

# Kernel configuration.
ALLOW_kmod_loading="no"
ENABLE_TPE="yes"
TPE_GROUP_POLICY="untrusted"
TPE_UNTRUSTED_USERS=""
TPE_TRUSTED_USERS=""
DISABLE_PRIVILEGED_IO="yes"
AUDIT_MOUNT="no"
AUDIT_CHDIR="no"
AUDIT_PTRACE="yes"
AUDIT_TEXTREL="no"
CHROOT_CAPS="yes"
CHROOT_DENY_CHMOD="yes"
CHROOT_DENY_CHROOT="yes"
CHROOT_DENY_FCHDIR="yes"
CHROOT_DENY_MKNOD="yes"
CHROOT_DENY_MOUNT="yes"
CHROOT_DENY_PIVOT="yes"
CHROOT_DENY_SHMAT="yes"
CHROOT_DENY_SYSCTL="yes"
CHROOT_DENY_UNIX="yes"
CHROOT_ENFORCE_CHDIR="yes"
CHROOT_EXECLOG="no"
CHROOT_FINDTASK="yes"
CHROOT_RESTRICT_NICE="yes"
EXEC_LOGGING="no"
EXEC_LOG_USERS=""
DMESG="yes"
EXECVE_LIMITING="yes"
FIFO_RESTRICTIONS="yes"
FORKFAIL_LOGGING="yes"
HARDEN_PTRACE="yes"
IP_BLACKHOLE="yes"
LASTACK_RETRIES="4"
LINKING_RESTRICTIONS="yes"
RESOURCE_LOGGING="no"
ROMOUNT_PROTECT="no"
RWXMAP_LOGGING="no"
SIGNAL_LOGGING="no"
SOCKET_ALL="yes"
SOCKET_USERS=""
SOCKET_CLIENT="yes"
SOCKET_CLIENT_USERS=""
SOCKET_SERVER="yes"
SOCKET_SERVER_USERS=""
TIMECHANGE_LOGGING="yes"


# Clamav configuration
CLAMAV_ENABLED="<%= node[:asl][:clamav][:enable] %>"
CLAMAV_ENABLE_DAZUKO="no"
CLAMAV_TCPADDRESS="127.0.0.1"
CLAMAV_SCANONACCESS="no"
CLAMAV_SCANONOPEN="no"
CLAMAV_SCANONCLOSE="no"
CLAMAV_SCANONEXEC="no"
CLAMAV_CLAMUKO_MAXFILESIZE="10m"

# PSMON configuration.
PSMON_ENABLED="<%= node[:asl][:psmon_enable] %>"
PSMON_NOTIFY="$NOTIFY"
PSMON_EMAIL="<%= node[:asl][:notify_email] %>"
PSMON_FROM="psmon@$HOSTNAME"

# OSSEC configuration
OSSEC_ENABLED="<%= node[:asl][:ossec][:enable] %>"
OSSEC_NOTIFY="no"
OSSEC_MODE="server"
OSSEC_USE_MYSQL="<%= node[:asl][:ossec][:use_mysql] %>"
OSSEC_DATABASE_SERVER="<%= node[:asl][:ossec][:mysql_server] %>"
OSSEC_DATABASE="<%= node[:asl][:ossec][:mysql_database] %>"
OSSEC_DATABASE_USERNAME="<%= node[:asl][:ossec][:mysql_user] %>"
OSSEC_DATABASE_PASSWORD="<%= node[:asl][:ossec][:mysql_pass] %>"
OSSEC_SERVER=""
OSSEC_EMAIL="<%= node[:asl][:notify_email] %>"
OSSEC_SMTP_SERVER="localhost"
OSSEC_FROM="ossec@$HOSTNAME"
OSSEC_MAX_MSG="1"
OSSEC_ACTIVE_RESPONSE="yes"
OSSEC_SHUN_ENABLE_TIMEOUT="yes"
OSSEC_SHUN_TIME="600"
HIDS_SHUN_MULTIPLIER="2"

# mod_security configuration
MODSEC_ENABLED="<%= node[:asl][:modsec][:enable] %>"
WAF_ENGINE="on"
WAF_CHROOTDIR="no"
WAF_READSTATELIMIT="1024"
MODSEC_SERVERSIG="Apache"
MODSEC_UPLOADDIR="/var/asl/data/suspicious"
MODSEC_RULES_PATH="/etc/httpd/modsecurity.d"
MODSEC_KEEPFILES="on"
MODSEC_LOGTYPE="Concurrent"
MODSEC_LOGFILE="audit_log"
MODSEC_LOGELEMENT="ABIFHZ"
MODSEC_REQMEMLIMIT="131072"
MODSEC_DEBUGLOG="no"
MODSEC_CLEAN_ALERT="30"
MODSEC_DATADIR="/var/asl/data/msa"
MODSEC_AUDITDIR="/var/asl/data/audit"
MODSEC_TMPDIR="/tmp"
MODSEC_RESPONSEBODYLIMIT="2621440"
MODSEC_REQUESTBODYLIMIT="134217728"
MODSEC_RESPONSEBODYLIMITACTION="ProcessPartial"
MODSEC_00_WHITELIST="no"
MODSEC_00_ANTIEVASION="yes"
MODSEC_00_STRICT="no"
MODSEC_00_RBL="no"
MODSEC_10_ANTIMALWARE="yes"
MODSEC_10_RULES="yes"
MODSEC_11_ADVANCED_RULES="yes"
MODSEC_12_BRUTE="yes"
MODSEC_20_USERAGENTS="yes"
MODSEC_30_ANTISPAM="<%= node[:asl][:modsec][:antispam] %>"
MODSEC_50_ROOTKITS="yes"
MODSEC_60_RECONS="yes"
MODSEC_61_RECONS_DLP="yes"
MODSEC_99_JITP="yes"
MODSEC_99_REDACTOR="no"
MODSEC_99_MALWARE_OUTPUT="yes"
MODSEC_99_SCANNER="yes"

# General PHP configuration options.
PHP_CHECKS="<%= node[:asl][:php][:checks] %>"
PHP_SAFE_MODE="no"
PHP_REGISTER_GLOBALS="no"
PHP_URL_FOPEN="yes"
PHP_URL_INCLUDE="no"
PHP_MAGIC_QUOTES_GPC="on"
PHP_MAGIC_QUOTES_RUNTIME="on"
ALLOW_dl="no"
ALLOW_escapeshellcmd="no"
ALLOW_curl_exec="no"
ALLOW_curl_multi_exec="no"
ALLOW_exec="yes"
ALLOW_ftp_exec="no"
ALLOW_leak="no"
ALLOW_passthru="yes"
ALLOW_pcntl_exec="no"
ALLOW_pfsockopen="no"
ALLOW_fsockopen="no"
ALLOW_phpinfo="yes"
ALLOW_popen="no"
ALLOW_posix_kill="no"
ALLOW_posix_mkfifo="no"
ALLOW_posix_setpgid="no"
ALLOW_posix_setsid="no"
ALLOW_posix_setuid="no"
ALLOW_proc_close="no"
ALLOW_proc_get_status="no"
ALLOW_proc_nice="no"
ALLOW_proc_open="no"
ALLOW_proc_terminate="no"
ALLOW_shell_exec="no"
ALLOW_show_source="no"
ALLOW_system="no"

# SSH daemon configuration.
SSH_STRICTMODE="yes"
SSH_IGNORE_RHOSTS="yes"
SSH_PUBKEY="<%= node[:asl][:ssh][:pubkey] %>"
SSH_ROOTLOGINS="<%= node[:asl][:ssh][:rootlogin] %>"
SSH_PASSWORD_AUTH="no"
SSH_PRIV_SEPARATION="yes"
SSH_GSSAPI_AUTH="no"
SSH_GSSAPI_CLEANUP="no"
SSH_BANNER="/etc/asl/banner"

# Rkhunter settings.
RKHUNTER_ENABLED="<%= node[:asl][:rkhunter][:enable] %>"
RKHUNTER_EMAIL="<%= node[:asl][:notify_email] %>"

# mod_evasive configuration.
MODEV_ENABLED="<%= node[:asl][:modevasive][:enable] %>"
MODEV_DOSHashTableSize="4096"
MODEV_DOSPageCount="5"
MODEV_DOSSiteCount="200"
MODEV_DOSPageInterval="2"
MODEV_DOSSiteInterval="2"
MODEV_DOSBlockingPeriod="25"

# Web App Inventory
APPINV_CRON="off"

# Plesk settings
PSA_DISABLE_CRONTAB="no"

# Master configuration flag. Do not modify
CONFIGURED="yes"
